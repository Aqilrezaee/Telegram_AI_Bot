import random
import re
from hazm import Normalizer, WordTokenizer, POSTagger

# 🔥 اسلنگ‌ها و واژگان عامیانه
slang_replacements = {
    "آزاردهنده": ["رو مخه", "رو اعصابه"],
    "شروع کنید": ["بزن بریم", "استارت بزن"],
    "بسیار خوب": ["خفنِ", "توپِ"],
    "امکان‌پذیر است": ["می‌شه راحت", "قابل انجامه"],
    "تلاش کنید": ["سعی‌تو بکن", "یه تلاشی بزن"],
    "توصیه می‌شود": ["پیشنهاد می‌کنم", "می‌گم امتحان کن"],
    "مطمئن شوید": ["حواست باشه", "یادت نره"],
    "به خاطر داشته باشید": ["یادت نره", "تو ذهنت نگه دار"],
    "سعی کنید": ["یه کاری کن که", "سعی کن یه جوری بشه"],
    "موارد زیر را رعایت کنید": ["این چیزا رو رعایت کن", "اینارو جدی بگیر"],
    "بسیار مهم است": ["خیلی مهمه ها!", "خیلی تو چشمه"],
    "حتماً انجام دهید": ["از دست نده", "حتماً یه کاریش بکن"],
    "انجام دهید": ["بکن دیگه", "یه حرکتی بزن"],
    "اطمینان حاصل کنید": ["مطمئن شو", "چک کن"],
    "ترجیحاً": ["اگه می‌شه", "ترجیح اینه"],
    "بررسی کنید": ["یه نگاهی بنداز", "چکش کن"],
    "لازم است": ["واجبه تقریباً", "حتماً لازمه"],
    "اجتناب کنید": ["بی‌خیالش شو", "ولش کن بهتره"],
    "احساس خوبی دارد": ["حال می‌ده", "تو دل می‌شینه"],
    "وقت‌گیر": ["گیر می‌کنی توش", "جونتو می‌گیره"],
    "پرهیز کنید": ["ولش کن بهتره", "ردش کن بره"],
    "مراقب باشید": ["حواست جمع باشه", "یه وقت سوتی ندی‌ها"],
    "تغذیه سالم": ["غذای درست‌درمون", "غذای حسابی"],
    "فعالیت بدنی": ["یه تکونی به خودت بده", "حرکت کن یکم"],
    "سبک زندگی سالم": ["زندگیِ آدمیزادی", "یه سبک خفن"],
    "ارتباط برقرار کنید": ["دستتو دراز کن", "یه سلامی بده"],
    "تمرکز کنید": ["ذهنو بذار روش", "حواست جمع باشه"],
    "احساس ناراحتی": ["دل‌گرفتگی", "تو مود نبودی"],
    "کمک می‌کند": ["حال می‌ده", "جواب می‌ده"],
    "اثربخش": ["جواب می‌ده", "کارو راه می‌ندازه"],
    "شاداب": ["با انرژی", "سرحال"],
    "پیشرفت کنید": ["یه پله برید بالا", "یه لِوِل برو بالا"],
    "تجربه کنید": ["یه بار بزن به دلش", "امتحانش کن"],
    "خوشایند": ["حال‌خوب‌کن", "خوش می‌گذره"],
    "بی‌فایده": ["هیچیش به درد نمی‌خوره", "کشکِ"],
    "بی‌دلیل": ["الکی", "بدون منطق"],
    "ساده": ["آب‌خوردنه", "راحت راحت"],
    "پیچیده": ["مغزمو خورد", "گره خورده‌ست"],
    "دل‌پذیر": ["دوست‌داشتنی", "حال‌خوب‌کن"],
    "با کیفیت": ["درجه‌یک", "می‌چسبه"],
    "بی‌کیفیت": ["داغونه", "افتضاحه"],
    "اطلاعات کافی": ["یه عالمه چیز دستت میاد", "دیتای توپ"],
    "ضروری است": ["واجب واجبه", "شوخی‌بردار نیست"],
    "با خیال راحت": ["تو آسایش", "بی‌استرس"],
    "مناسب است": ["می‌چسبه", "خوبه بهت میاد"],
    "استراحت کنید": ["یه نفسی بگیر", "یه چرت بزن"],
    "آشنا شوید": ["یاد بگیرش", "بیا تو جریان"],
}


# تکه‌کلام‌های انسانی
human_touch = [
    "ببین رفیق،",
    "خداییش راستشو بخوای،",
    "حالا جدا از شوخی،",
    "راستی یه چیزی!",
    "یه چیزی بگم تهش بخندی 😄",
    "حالا فرض کن اینجوریه که...",
    "یهو دیدی یه چیزی شد که باورت نشد!",
    "بذار اینجوری بگم:",
    "خلاصه تهش چی میشه؟",
    "اصن یه وضی!",
    "جونِ تو،",
    "قول می‌دم اینو خودت هم حس کردی!",
    "می‌دونی چی حال می‌ده؟",
    "بشین یه لحظه، کارت دارم!",
    "تهش اینه که راحتی یا نیستی.",
    "اگه من جات بودم،",
    "راستش خودمم موندم 😅",
    "چیزی که گفتنیه اینه:",
    "به جون خودم،",
    "باور نمی‌کنی ولی حقیقت داره!",
    "دیگه بستگی به خودته رفیق!",
    "یه چیزی بگم ولی نگی خودت گفتی 😅",
    "حالا بیا منطقی نگاه کنیم...",
    "ولی خب انصافاً،",
    "یادت نره که زندگی خیلی شوخ‌طبع‌تر از ماست!",
    "نپرس چرا! فقط بدون که...",
    "آقا بذار رک بگم:",
    "یه چیزی ته ذهنم می‌گه که...",
    "می‌خوام یه چیزی بگم، دلت نخواد تموم شه!",
    "قضیه از اونجایی شروع شد که...",
    "خلاصه بگم که،",
    "دیگه نگو نگفتی!",
    "حس می‌کنم یه چیزی کم داره، نه؟",
    "تو هم اگه بودی، همینو می‌گفتی!",
    "باور کن این یکی با بقیه فرق داره!",
    "حالا جدای از همه‌ی اینا،",
    "اصلاً عجیب غریب نیست اگه...",
    "بیا و ببین چه خبره!",
    "یه جورایی شبیه قصه‌ست، ولی واقعیه!",
    "مثلاً فرض کن یه روز اینجوری شه...",
    "ته دلت می‌فهمی چی می‌گم!",
    "اگه بخوای خودتو تو این شرایط بذاری،",
    "فقط خدا می‌دونه تهش چی میشه!",
    "یعنی رسماً هنگ کردم!",
    "بابا دمت گرم که تا اینجا اومدی!",
    "یه چیزایی هست که فقط تو می‌فهمی!",
    "اصلاً ببین چی شده رفیق!",
    "می‌دونی چی بگم؟ هیچی نگو 😅",
    "خنده‌داره ولی واقعی!",
    "یاد اون موقع افتادم که...",
    "باورم نمی‌شد ولی شد!",
    "یعنی اگه تو فیلم می‌دیدم، نمی‌باوردم!",
    "ته دل آدمو خالی می‌کنه این یکی!",
    "راستش اولش جدی نگرفتم، ولی بعد...",
    "حالا اگه باورت نمی‌شه، خودت ببین!",
    "یه چیز بگم ولی نخندی 😄",
    "یه خورده عجیب نیست؟",
    "تو هم اگه باشی همین کارو می‌کنی!",
    "به جان خودم، انگار دنیا عوض شده!",
    "خب بذار برات روشن‌ترش کنم...",
    "حالا یه چیز دیگه‌م هست که بگم:",
    "نه که بخوام بترسونمت، ولی...",
    "ولی یه شرط داره! اونم اینه که...",
    "تا حالا شده همچین چیزی برات پیش بیاد؟",
    "با خودم گفتم یعنی میشه؟",
    "خلاصه ما موندیم و دنیای عجیبش!",
    "یادش بخیر، یه بار یه همچین چیزی شد...",
    "یعنی نگو نگفتی بعداً!",
    "از ما گفتن بود 😎",
    "یعنی واقعاً تهش اینجوریه؟",
    "نمی‌دونم چرا ولی یه حس خاصی داشت!",
    "همیشه ته تهش یه چیزی یادمون می‌مونه!",
    "تو هم اگه اینجوری فکر کنی، می‌فهمی چی می‌گم!",
    "هیچی دیگه، رفت که رفت!",
    "بیا خودمونیم، یه جورایی باحاله!",
    "حالا جدی جدی بریم سر اصل مطلب!",
    "می‌دونی فرق آدم عادی با خاص چیه؟",
    "برو حالشو ببر 😄",
    "بسه دیگه مقدمه‌چینی، بریم سر اصل حرف!",
    "اگه بخوای حساب کنی، تهش مهمه کی خوشحال‌تره!",
    "تو خودت قضاوت کن دیگه!",
    "گاهی یه تصمیم کوچیک، همه‌چی رو عوض می‌کنه!",
    "حالا چرا اینو گفتم؟ چون مهمه!",
    "یه لحظه وایسا، این یکی فرق داره!",
    "بعضی وقتا یه حرف کوچیک، کلی فرق می‌سازه!",
    "اگه دنبال راهی، همینشه!",
    "می‌خوام یه چیزی بهت بسپرم، یادت نره!",
    "اگه تا اینجاش خوندی، دمت گرم!",
    "اصن بعضی چیزا گفتنی نیست، حس‌کردنیه!",
    "اگه خودت نباشی، کی می‌خواد باشه؟",
    "هر کی یه راهی داره، اینم یکی از راه‌هاشه!",
    "تو این دنیا یه چیز همیشه درسته: خودت باش!",
    "بیا صادق باشیم با خودمون!",
    "فقط یه چیزی بگم که به دلت بشینه!",
    "اینم بگم دیگه ببندیمش!",
    "ته تهش چی می‌مونه؟ حال خوب!",
    "می‌خوام یه بارم شده، تو باور کنی!",
    "می‌دونی فرقش کجاست؟ توی دل آدمه!",
    "قشنگ معلومه ته دلت چی می‌خوای!",
    "برو جلو، نترس! دنیاس دیگه!",
]


def paraphrase_structure(text):
    patterns = [
    (r"(من فکر می‌کنم که)\s+(.+?)", r"\2 به نظرم"),
    (r"(مهم است که)\s+(.+?)", r"بهتره که \2"),
    (r"(اگر)\s+(.+?)،\s+(آن‌گاه)", r"اگه \2، اون‌وقت"),
    (r"(برای اینکه)\s+(.+?)", r"تا \2"),
    (r"(به نظر می‌رسد که)\s+(.+?)", r"فک کنم \2"),
    (r"(با توجه به اینکه)\s+(.+?)", r"چون \2"),
    (r"(امکان دارد که)\s+(.+?)", r"شاید \2"),
    (r"(تمایل دارم که)\s+(.+?)", r"می‌خوام \2"),
    (r"(نباید فراموش کرد که)\s+(.+?)", r"یادمون نره که \2"),
    (r"(تصمیم گرفتم که)\s+(.+?)", r"گفتم که \2"),
    (r"(مایلم که)\s+(.+?)", r"دلم می‌خواد \2"),
    (r"(در صورتی که)\s+(.+?)", r"اگه \2"),
    (r"(نکته قابل توجه این است که)\s+(.+?)", r"یه چیز مهم اینه که \2"),
    (r"(شایسته است که)\s+(.+?)", r"خوبه که \2"),
    (r"(توصیه می‌شود که)\s+(.+?)", r"بهتره که \2"),
    (r"(در نتیجه)\s+(.+?)", r"واسه همین \2"),
    (r"(همانطور که می‌دانید)\s+(.+?)", r"همون‌طور که می‌دونی \2"),
    (r"(بنابراین)\s+(.+?)", r"پس \2"),
    (r"(در حال حاضر)\s+(.+?)", r"الان \2"),
    (r"(پیشنهاد می‌شود که)\s+(.+?)", r"پیشنهاد می‌کنم \2"),
    (r"(ضروری است که)\s+(.+?)", r"لازمه که \2"),
    (r"(ممکن است که)\s+(.+?)", r"شاید \2"),
    (r"(به هیچ وجه)\s+(.+?)", r"اصلاً \2"),
    (r"(باید پذیرفت که)\s+(.+?)", r"باید قبول کرد که \2"),
    (r"(این احتمال وجود دارد که)\s+(.+?)", r"ممکنه \2"),
    (r"(در این خصوص)\s+(.+?)", r"راجع به این موضوع \2"),
    (r"(با در نظر گرفتن)\s+(.+?)", r"اگه در نظر بگیریم \2"),
    (r"(قابل توجه است که)\s+(.+?)", r"جالبه که \2"),
    (r"(لازم به ذکر است که)\s+(.+?)", r"بد نیست بدونی که \2"),
]

    for pattern, repl in patterns:
        text = re.sub(pattern, repl, text)
    return text



def insert_minor_irrelevance(text):
    fillers = [
    "راستی دیروز یادم افتاد یه همچین چیزی شنیده بودم.",
    "حالا به این ربطی نداره ولی یه بار همچین چیزی دیدم!",
    "اینم بگم، شاید بی‌ربط باشه ولی جالبه بدونی.",
    "یهو یاد یه چیزی افتادم، بذار اینم بگم.",
    "حالا که بحثش شد، یه چیزی بگم.",
    "نمی‌دونم چرا یاد این افتادم، ولی گفتم بگم شاید به کارت بیاد.",
    "تو پرانتز بگم، اینو چند وقت پیش شنیدم.",
    "یه چیزی بگم که شاید جالب باشه، البته بی‌ربطه.",
    "وسط حرفام اینو یادم اومد، حیفم اومد نگم.",
    "یه خاطره بی‌ربط بگم، ولی خنده‌داره!",
    "در ضمن، یه نکته بی‌ربط ولی باحال!",
    "یه چیزی بگم که اصل داستان نیست، ولی ذهنمو درگیر کرده.",
    "راستی! یه چیز الکی یادم افتاد الان!",
    "در حاشیه بگم، اینم شنیدم جالبه بود.",
    "حالا که داریم حرف می‌زنیم، بذار یه چیزی اضافه کنم.",
    "یه نکته بی‌ربط ولی باحال که دلم می‌خواد بگم.",
    "راستی! نمی‌دونی چند وقت پیش چی شد!",
    "اصلاً بی‌ربطه، ولی خب بامزه‌ست.",
    "ببخش که وسط حرف پَریدم، ولی یه چیز یادم اومد.",
    "همینجوری که حرف می‌زنم، یه چیزی اومد تو ذهنم.",
    "اینم بگم و دیگه ادامه بدیم.",
    "یه چیزی شنیدم که هنوز تو ذهنمه، گفتم شاید تو هم خوشت بیاد.",
    "در موردش نیست، ولی بی‌ربط هم نیست اگه دقیق نگاه کنی.",
    "الان یادم افتاد، گفتم شاید به درد بخوره.",
    "وسط بحث یه لحظه بپرسم، بعدش ادامه می‌دیم.",
    "بی‌خیال موضوع اصلی، یه چیز جالب بگم!",
]

    sentences = re.split(r'(?<=[.!؟])\s+', text)
    if len(sentences) > 2 and random.random() < 0.3:
        idx = random.randint(1, len(sentences)-2)
        sentences.insert(idx, random.choice(fillers))
    return " ".join(sentences)




# 1. سبک‌های مختلف گفتار
tones = [
    "اگه بخوام بی‌پرده بگم، ",
    "از اون چیزاست که با دل فهمیدم، نه با منطق خشک: ",
    "بذار اینو بهت بگم، از زخم‌هایی که خوردم یاد گرفتم: ",
    "یه بار یکی یه حرفی زد، هیچ‌وقت از ذهنم پاک نشد: ",
    "اگه به گذشته برمی‌گشتم، شاید فقط یه چیزو عوض می‌کردم: ",
    "باور کن درد بعضی چیزا، حتی بعدِ سال‌ها هم آروم نمی‌گیره: ",
    "من راه زیادی رفتم تا بفهمم، بعضی درها هیچ‌وقت باز نمی‌شن: ",
    "یه وقتایی حرف نزدن از هزار تا فریاد بلندتره: ",
    "وقتی چشم آدم پر اشکه، دیگه خوب نمی‌بینه که قضاوت کنه: ",
    "هیچ‌کس نمی‌تونه اندازه‌ی سکوت یه پدر پیر، حکمت داشته باشه: ",
    "یه وقتایی فقط با تکیه دادن به دیوار اتاق، آدم به جواب می‌رسه: ",
    "من یاد گرفتم اگه چیزی رو با دل ندی، با حرف نمی‌شه جبرانش کرد: ",
    "کاش اون موقع می‌فهمیدم بعضی رفتنا، برگشتی نداره: ",
    "تو زندگی، بعضی درس‌ها رو فقط باید با از دست دادن یاد گرفت: ",
    "پشت هر لبخندِ تلخی که دیدم، یه دنیای پنهون بود: ",
    "بعضی چیزا رو نمی‌شه گفت، فقط می‌شه حس کرد اگه خودت ازش گذشتی: ",
    "هر چی بیشتر گذشت، فهمیدم سکوت بعضی آدما، به خاطر صداهاییه که تو دلشونه: ",
    "با دلِ خسته‌ست که آدم حرفای واقعی رو می‌زنه، نه وقتی همه چی رو رواله: ",
    "یه وقتایی دنیا با یه جمله ساده می‌زنه تو صورتت: ",
    "پیری فقط چین و چروک نیست، وزنِ خاطراتیه که دوش می‌کشی: ",
    "اگه یه چیز از این زندگی فهمیدم اینه که همیشه حقیقت ساده نیست: ",
    "کاش اون موقع کسی بود بهم بگه: «بعضی دردا رو باید بغل کرد، نه حل» ",
    "آدم اگه زخم نخوره، هیچ‌وقت رشد نمی‌کنه: ",
    "من همیشه از آدما چیز یاد گرفتم، حتی از اونایی که ازم بریدن: ",
    "یه جایی تو راه، فهمیدم که باید یاد بگیرم نبخشم، اما رها کنم: ",
    "هر چی بیشتر حرف بزنی، کمتر می‌فهمی: ",
    "گاهی باید بذاری دلت بترکه، تا دلت جا باز کنه برای فهمیدن: ",
    "اگه یه چیزی هست که تو این سالا یاد گرفتم، اینه که هیچ‌کس بی‌نقص نیست، ولی بعضیا ارزش ریسک دارن: ",
    "یه روزایی بود که فکر می‌کردم دنیا با من لج کرده... الان می‌فهمم داشتم رشد می‌کردم: ",
    "حرف دل بعضی آدما رو فقط سکوتاشونه که می‌زنه بیرون: ",
    "سخت‌ترین بخش زندگی؟ وقتی باید قوی بمونی، اما دلت گریه می‌خواد: ",
    "آدمای واقعی، کم‌حرف‌ترن... چون خوب می‌دونن حرف چه قدرتی داره: ",
    "همیشه دنبال این بودم که بفهمم چرا... ولی بعضی چیزا فقط باید بگذری تا آروم شی: ",
    "یه وقتایی، فقط زمانه که جواب می‌ده، نه هیچ منطقی: ",
    "از بس خوردم زمین، دیگه پاهام زمین رو دوست دارن: ",
    "به یه سنی که می‌رسی، دیگه دنبال جواب نمی‌گردی، دنبال آرامشی: ",
    "وقتی سکوت می‌کنم، یعنی دارم می‌سنجی، نه اینکه نمی‌فهمم: ",
    "یه نصیحت که هیچ‌وقت یادم نمی‌ره: «اونی که صبر می‌کنه، همیشه نمی‌بازه» ",
    "وقتی دلت پُر باشه، دیگه حوصله جنگ نداری، فقط می‌ری: ",
    "باور کن بعضی اشک‌ها شجاع‌ترین تصمیم‌ها رو می‌سازن: ",
    "تو زندگی، بعضی فصل‌ها بی‌هوا می‌رسن... بدون مقدمه، فقط میان و می‌رن: ",
    "از یه جایی به بعد، دیگه خودت می‌شی پشت‌وپناه خودت: ",
    "یه بار یکی گفت: «مشکلاتت رو با لبخند حل کن.» گفتم: «باشه، ولی اول بگو چطوری بخندم!» ",
    "آدمایی که خیلی ساکتن، معمولاً با خودشون هزار گفت‌وگو دارن: ",
    "وقتی واقعاً بفهمی، دیگه بحث نمی‌کنی... فقط رد می‌شی: ",
    "گاهی باید بذاری همه چی بریزه پایین، تا یه چیز واقعی از نو بسازی: ",
    "تو این سن، دیگه دنبال مقصر نمی‌گردم، دنبال صلح می‌گردم: ",
    "همه دنبال درک شدن‌ان، ولی کسی حوصله شنیدن نداره: ",
    "تنهایی بده، ولی تنهایی کنار آدمای اشتباه بدتره: ",
    "هیچ‌وقت درد واقعی رو اون کسی نمی‌فهمه که فقط شنیده، نه زندگی کرده: ",
    "بزرگ‌ترین درس زندگی؟ اون جاییه که تنها می‌شی، ولی قوی‌تر از همیشه بلند می‌شی: ",
]


# 2. افکت تجربه شخصی
personal_touch = [
    "یه بار همچین جریانی برام پیش اومد، به قول معروف: «آب که سر بالا میره، قورباغه ابو عطا می‌خونه».",
    "وقتی اینو شنیدم، یاد اون روز افتادم که گفتم: «آفتابه لگن هفت دست، شام و ناهار هیچی».",
    "یه بار یه تصمیم اشتباه گرفتم، مادربزرگم گفت: «اومدی ثواب کنی، کباب کردی».",
    "یه بار همچین سوتی دادم، تهش فهمیدم: «با دست پس می‌زنه، با پا پیش می‌کشه».",
    "یه شب با خودم کلنجار رفتم، تا اینکه به خودم گفتم: «هر کی خربزه می‌خوره، پای لرزشم می‌شینه».",
    "یه بار به یکی اعتماد کردم، ولی آخرش شد حکایت: «از پوست گردو توقع بادام نداشته باش».",
    "یه بار یه اشتباهی کردم که هنوزم می‌سوزه، به قول معروف: «آب ریخته رو نمی‌شه جمع کرد».",
    "یه بار انقدر خام بودم که تهش دیدم: «گنجشک روزی هزار بار تو باغ نمی‌پره».",
    "یه بار همچین اشتباهی کردم، بعد گفتن: «به هر کی گفتی جون، سرتو برید».",
    "یاد اون روز افتادم که یکی گفت: «کوزه‌گر از کوزه شکسته آب می‌خوره».",
    "یه روزی فکر می‌کردم دنیا دستمه، ولی فهمیدم: «باد آورده رو باد می‌بره».",
    "یه بار یه کسی رو نادیده گرفتم، آخرش شد حکایت: «قدر زر، زرگر شناسد؛ قدر گوهر، گوهری».",
    "یه بار یکی برام کاری کرد، از اون خوبا، گفتم: «کار نیکو کردن از پر کردن است».",
    "وقتی همچین حرفی شنیدم، با خودم گفتم: «چراغی که به خانه رواست، به مسجد حرامه».",
    "یه بار دلم سوخت برا کسی، ولی آخرش فهمیدم: «نیکی چو از حد بگذرد، نادان خیال بد کند».",
    "یه تجربه‌ای دارم که بوی همون جمله رو می‌ده: «نه به اون شوری شور، نه به این بی‌نمکی».",
    "یاد اون روزایی افتادم که بی‌حساب عشق می‌دادم، ولی تهش شد: «نه خوردیم نونی، نه دیدیم روغنی».",
    "یه بار از یه رفیق قدیمی خوردم، همون شد که می‌گن: «دود از کنده بلند می‌شه».",
    "وقتی این اتفاق افتاد، دلم گفت: «نه هر که چهره برافروخت، دلبری داند».",
    "یه بار همچین جمله‌ای شنیدم و انگار یه پتک خورد وسط مغزم: «به در گفتند دیوار بشنوه».",
    "یه بار یکی دل منو شکست، خودم گفتم: «خشت اول چون نهد معمار کج، تا ثریا می‌رود دیوار کج».",
    "یه خاطره‌ی تلخ دارم که همیشه باهامه، عین اینه که: «هم خر رو خواستن، هم خرما رو».",
    "یه بار توی تنگنا گیر کردم، یاد اون جمله افتادم: «بی‌مایه فطیر است».",
    "یه بار با دل راه افتادم، ولی تهش فهمیدم: «اسب رو ول کردی، به پالون چسبیدی؟».",
    "یه بار تو دوستی عجله کردم، دیدم مصداقه: «آب ندیده، رختش رو آب انداخت».",
    "یه بار همچین جریانی پیش اومد، بعد بهم گفتن: «ماهی رو هر وقت از آب بگیری، تازه‌ست».",
    "یه بار تو زندگی‌م یه تصمیم سخت گرفتم، ولی بعداً فهمیدم: «دل به دل راه داره، ولی بعضی وقتا راهش بنده».",
    "یه خاطره دارم که همیشه با منه، مثل خاری که هیچ وقت از پام درنیومد.",
    "یاد اون شب افتادم که نشسته بودم لب پنجره و فقط به این فکر می‌کردم که چرا همه چی این شکلی شد.",
    "یه بار یه کاری کردم که هنوز پشیمونم، ولی همون شد که می‌گن: «سیلی نقد به از حلوای نسیه‌ست».",
    "یه بار یکی گفت: «بیا ببخشیم»، ولی من هنوز اون زخمو یادمه... می‌گن: «بخشیدن خوبه، ولی فراموشی نه».",
    "یه شب مادرم گفت: «هرچی سنگه مال پای لنگه»... اون شب رو هیچ‌وقت یادم نمی‌ره.",
    "یه بار یه تجربه داشتم که تلخیش از زهرم بیشتر بود، ولی گفتن: «آنچه مارا نکشد، قوی‌ترمان می‌کند».",
    "وقتی اون حرفو زدی، یه لحظه رفتم تو گذشته، وقتی هنوز باور داشتم حرف آدما راست و حسینیه.",
    "یه بار با یکی بحثم شد، آخرش فقط گفت: «در باغ سبز نشونت دادن، حالا رسیدی به خارزار».",
    "تو یکی از سخت‌ترین لحظه‌های زندگیم، فقط یه جمله تو گوشم تکرار می‌شد: «آب از سر گذشت، چه یه وجب چه صد وجب».",
    "یه بار گفتم نه، ولی با دلم راه نیومدم... شدش مثل: «کسی که دل داده، دیگه عقل نمی‌شنوه».",
    "وقتی فهمیدم دروغ گفته، یهو یادم اومد: «دروغگو کم‌حافظه‌ست».",
    "یه بار خودم دلم خواست سکوت کنم، چون می‌گن: «جواب ابلهان خاموشی‌ست».",
]


# 3. ایرادات انسانی
human_like_glitches = [
    "اِممم... صبر کن ببینم چی داشتم می‌گفتم...",
    "آهان... نه، نه... اشتباه شد!",
    "اوووف ذهنم پرید یه‌ور دیگه کامل!",
    "یعنی در واقع... خب، چطور بگم...",
    "حواسم یه لحظه پرت شد، الان دقیقاً چی می‌گفتم؟",
    "عه خب... واژه‌اش رو نوک زبونمه، ولی در نمیاد!",
    "بذار یه لحظه فکر کنم... اوکی، یادم نمیاد!",
    "نه صبر کن، اون حرفم یه‌کم نامفهوم بود.",
    "الان قاطی کردم، یه لحظه صبر بده.",
    "یعنی چی می‌خواستم بگم؟ وای، ذهنم هنگ کرده!",
    "ببین بذار یه جور دیگه بگم شاید بهتر باشه.",
    "ذهنم سفید سفید شده، هیچی یادم نمیاد.",
    "عه نه، منظورم اون نبود... اشتباه گفتم.",
    "الان حرف از دهنم پرید ولی خودم نگرفتم چی گفتم!",
    "اوکی، یه لحظه حواسم نبود، از کجا داشتم می‌گفتم؟",
    "هوم... نمی‌دونم دقیقاً کجا داشتم می‌رفتم با این حرفم!",
    "ببین راستش الان یه چیزی ته ذهنمه ولی نمیاد بالا.",
    "یه لحظه صبر کن، جمله‌بندیم پرید!",
    "نه خب، اشتباه برداشت نکن، یعنی منظورم این نبود...",
    "الان قاطی کردم خودمم، یه‌کم گنگ شدم!",
    "این لحظه‌هایی که آدم همه چی یادش می‌ره رو دوست ندارم.",
    "وای، صبر کن، داشتم یه چیز خیلی مهم می‌گفتم...",
    "مغزم مثل مودم ری‌استارت شد یهویی!",
    "نه نه نه، این نبود اون چیزی که می‌خواستم بگم.",
    "چی داشتم می‌گفتم؟ هییی ذهنم پرید!",
    "یه کم زمان بده دارم دوباره جمع‌بندی می‌کنم تو ذهنم.",
    "ببین یه جوری بود که... آخه خب، چطوری بگم؟",
    "دوباره قفل کردم... این دومین بار توی یه دقیقه‌ست!",
    "وای یعنی حرفم خیلی پرت شد الان!",
    "الان فک کنم حرفم یه کم مسخره بود، بی‌خیال...",
    "خب راستش مطمئن نیستم چی می‌خواستم نتیجه بگیرم.",
    "اینم از اون حرفا بود که خودمم نفهمیدم چی گفتم.",
    "بذار جمله‌ام رو اصلاح کنم... نه، خراب‌تر شد.",
    "دقیقاً نمی‌دونم چی می‌خوام بگم ولی یه حس کلی دارم.",
    "ذهنم الان داره لگ می‌زنه، وایسا یه لحظه.",
    "یعنی واقعاً نمی‌دونم چرا اینو گفتم الان!",
    "اوووف الان چی شد؟ حرف از کجا رفت به کجا؟",
    "یه لحظه فکر کردم که فکر می‌کنم!",
    "آهان نه، داشتم اشتباه می‌رفتم بحثو.",
    "یه‌جورایی ذهنم کلا خاموشه الان!",
    "این جمله آخرم اصلاً معنی نداشت، خودمم فهمیدم.",
    "حرفم پرید وسط جمله، برمی‌گرده یا نه؟",
    "صادقانه بگم، الان فقط دارم چرت و پرت می‌گم!",
    "آخ آخ این جمله‌ام بی‌ربط شد، ببخش.",
    "اوه شت، الان یه چیز باحال یادم اومد ولی رفت!",
    "ذهنم مثل ویندوز هنگ کرد با اون ارور معروف!",
    "هوم... اوکی، ندارم دیگه، واقعاً خالی شدم.",
    "اِی وای! جمله تو ذهنم چیده شد ولی دهنم اجراش نکرد!",
    "می‌دونی اون حسی که می‌خوای چیزی بگی ولی گم می‌کنی؟ همینه!",
    "چی داشتم می‌گفتم؟ بیخیال، بیاید یه چیز دیگه بگیم.",
    "الان حس می‌کنم مغزم دو تا فایل باز کرده قاطی کرده!",
    "خودمم الان نمی‌فهمم چی گفتم، وایسا ری‌فرش شم!",
    "اینجوری نمی‌شد گفت، ببخشید، غلط املایی ذهنی بود!",
    "اوه نه! فکرم رفت سر یه موضوع دیگه یهو!",
    "یعنی جمله تو ذهنم ساختار داشت ولی وسط راه فرو ریخت.",
    "الان فقط سعی دارم مثل آدم حرف بزنم ولی انگار نمی‌شه!",
    "ذهنم داره سیگنال‌های ناقص می‌فرسته، ببخش!",
    "یه لحظه ذهنم ری‌استارت شد، مثل وقتی لپ‌تاپ داغ می‌کنه!",
    "ای بابا، باز شد این لحظه‌هایی که باید جمله رو پس بگیرم!",
    "صبر کن، گم شدم تو جمله‌ام. برگردم عقب یه کم.",
    "اون حرف آخری رو ول کن، بیایم از اول بچینیمش!",
    "اهههه چرا یادم نمیاد چی می‌خواستم بگم؟!",
    "الان حس یه صفحه سفید ورد رو دارم، هیچی روش نیست!",
    "ذهنم یه عالمه جمله داره ولی نوبت نمی‌دن بهم!",
]


# 4. ارجاع‌سازی جعلی یا واقع‌نما
references = [
    "در کتاب «ذهن خلاق» تألیف دکتر مهدی بختیاری، نشر نی (۱۳۹۵)، با تمرکز بر پرورش عادت‌های فکری خلاقانه، مسیرهای تقویت تفکر واگرا شرح داده شده است.",
    "بررسی آماری دپارتمان روان‌شناسی دانشگاه علامه (۱۳۹۸) نشان داد که آموزش مهارت‌های حل مسئله‌ی باز به‌طور مستقیم با ارتقای خلاقیت در دانشجویان مرتبط است.",
    "ویژه‌نامه‌ی مهرنامه با عنوان «نوآوری و قدرت نرم» (شماره ۴۳، زمستان ۱۳۹۶)، در مقاله‌ای از دکتر سمیرا احمدی، ضعف ساختارهای سنتی آموزش را عاملی در سرکوب خلاقیت معرفی می‌کند.",
    "در فصلنامه‌ی «روان‌شناسی شناختی کاربردی» (جلد هشتم، شماره دوم)، اثر محیط‌های باز، منعطف و بدون کنترل سخت‌گیرانه بر رشد خلاقیت در کارمندان بررسی شده است.",
    "مصاحبه‌ی دکتر حمیدرضا ارجمند با روزنامه شرق (اردیبهشت ۱۴۰۰) تأکید دارد که تعامل بین‌فردی و بازخورد در فضای آموزشی از عوامل فعال‌سازی ذهن خلاق است.",
    "گزارش رسمی یونسکو با عنوان «Education 2030» (۲۰۱۹) خلاقیت را یکی از چهار مهارت کلیدی قرن ۲۱ می‌داند که باید در نظام‌های آموزشی نهادینه شود.",
    "پادکست «مغز نو» (قسمت ۱۲، بهار ۱۴۰۲) با اجرای دکتر نادر رضایی، به بررسی تأثیر مدیتیشن و تمرکز آگاهانه بر شبکه‌های عصبی مرتبط با خلاقیت پرداخت.",
    "مقاله‌ی نشریه «Neuroscience Today» (شماره ۲۴۸، مارس ۲۰۲۰) بیان می‌کند که هنرهای تجسمی با فعال‌سازی سیستم پاداش مغز، مسیرهای خلاقیت را تقویت می‌کنند.",
    "کتاب «The Runaway Species» اثر David Eagleman و Anthony Brandt (۲۰۱۷) نشان می‌دهد که خلاقیت اغلب از بازسازی و ترکیب مجدد داده‌های آشنا حاصل می‌شود.",
    "برنامه «زاویه» شبکه چهار با حضور دکتر کاوه منصوری (۱۴۰۱) تأکید داشت که لحظات خلوت و قطع از دنیای دیجیتال، بستر اصلی برای شکل‌گیری ایده‌های نو هستند.",
    "تحقیقات ترزا آمابیل در HBR (۲۰۲۰) نشان داد که انگیزه‌ی درونی، و نه پاداش بیرونی، قوی‌ترین محرک برای بروز خلاقیت پایدار است.",
    "در Scientific American Mind (۲۰۱۸)، مقاله‌ای چاپ شد که ارتباط خواب دیدن و خیال‌پردازی با نوآوری ذهنی از دیدگاه علوم اعصاب را بررسی می‌کرد.",
    "مطالعه‌ی دانشگاه استنفورد (۲۰۱۹) نشان داد که پیاده‌روی در طبیعت باعث افزایش چشمگیر در توانایی تولید ایده‌های جدید می‌شود.",
    "گزارش رسمی مرکز تحقیقات راهبردی ریاست جمهوری ایران (۱۳۹۹) پیشنهاد می‌کند که سیاست‌گذاری فرهنگی خلاقانه، عامل تسریع نوآوری در نسل جوان است.",
    "در کتاب «خلاقیت: روان‌شناسی کشف و اختراع» نوشته‌ی Mihaly Csikszentmihalyi، رابطه‌ی بین لذت تجربه‌ی «جریان» و خلق آثار نو بررسی شده است.",
    "در پادکست «Hidden Brain» (اپیزود «Creatures of Habit»، سال ۲۰۲۱)، به بررسی تضاد میان عادت و خلاقیت و روش‌های متعادل‌سازی آن‌ها پرداخته شد.",
    "پایگاه خبری BBC Future در مقاله‌ای تحلیلی (ژوئن ۲۰۲۲) توضیح می‌دهد که بازی‌های نقش‌آفرینی و خیال‌پردازی در کودکی، پیش‌بینی‌کننده‌ی خلاقیت در بزرگسالی‌اند.",
    "در مستند Netflix با عنوان «The Creative Brain» (۲۰۱۹) با حضور David Eagleman، عملکرد مغز در هنگام خلق آثار هنری و نوآوری‌های علمی بررسی می‌شود.",
    "تحقیقات روان‌سنجی دانشگاه تورنتو (۲۰۲۰) نشان داده که استفاده از موسیقی بی‌کلام در حین انجام فعالیت‌های ذهنی باعث افزایش انعطاف‌پذیری شناختی می‌شود.",
    "طبق داده‌های «Global Innovation Index» در سال ۲۰۲۱، کشورهایی که سیستم آموزشی‌شان بر مهارت‌های نرم، از جمله تفکر انتقادی و خلاقیت تأکید دارد، در نوآوری فناورانه نیز پیشتازند.",
    "نشریه «فلسفه برای کودکان» چاپ مؤسسه فبک ایران، در مقاله‌ای از دکتر شیرین عطری (۱۴۰۲) به این نکته اشاره می‌کند که تقویت گفت‌وگوهای انتقادی در کودکان می‌تواند زمینه‌ساز رشد خلاقیت در بزرگ‌سالی باشد.",
    "در کنفرانس بین‌المللی «آینده‌ی کار» در دوبی (۲۰۲۲)، بخش ویژه‌ای به هوش هیجانی و خلاقیت سازمانی اختصاص داده شده بود که تأکید می‌کرد رهبران خلاق بیشترین نقش را در حفظ پویایی تیم‌ها ایفا می‌کنند.",
    "در مقاله‌ی پژوهشی دانشگاه UCL (University College London، ۲۰۱۸)، نقش «عدم قطعیت هدفمند» در تحریک ذهن برای راه‌حل‌های بدیع و نوآورانه بررسی شده است.",
]


# 5. تعویض ساختاری
structure_replacements = [

    # ==== افعال متداول رسمی به محاوره ====
    (r"می‌شود", "میشه"),
    (r"نمی‌شود", "نمیشه"),
    (r"می‌تواند", "میتونه"),
    (r"نمی‌تواند", "نمیتونه"),
    (r"خواهد شد", "قراره بشه"),
    (r"نخواهد شد", "قرار نیست بشه"),
    (r"باید", "باید حتما"),
    (r"نباید", "اصلاً نباید"),
    (r"ممکن است", "شاید"),
    (r"لازم است", "لازمه"),
    (r"تمایل دارند", "میل دارن"),
    (r"تمایلی ندارند", "دلشون نمی‌خواد"),
    (r"نیاز است", "نیازه"),
    (r"ضروری است", "واجبه"),
    (r"پیشنهاد می‌شود", "پیشنهاد می‌کنن"),
    (r"اجرا خواهد شد", "قراره اجرا بشه"),
    (r"توصیه می‌شود", "می‌گن بهتره"),
    (r"نشان می‌دهد", "نشون میده"),
    (r"نشان داده است", "نشون داده"),
    (r"بررسی کرده‌اند", "بررسی کردن"),
    (r"گزارش داده‌اند", "گزارش دادن"),
    (r"تحلیل کرده‌اند", "تحلیل کردن"),
    (r"تصمیم گرفته‌اند", "تصمیم گرفتن"),

    # ==== افعال اسنادی و شبه‌فعلی ====
    (r"است", "هست"),
    (r"نیست", "نیستش"),
    (r"بود", "بودش"),
    (r"نبود", "نبودش"),
    (r"خواهد بود", "قراره باشه"),
    (r"وجود دارد", "هست"),
    (r"وجود ندارد", "نیست"),
    (r"حضور دارد", "هست تو صحنه"),
    (r"حضور ندارد", "غایبه"),

    # ==== قیدهای رسمی و سنگین ====
    (r"همواره", "همیشه"),
    (r"اغلب", "اکثراً"),
    (r"به شدت", "خیلی زیاد"),
    (r"کاملاً", "صد در صد"),
    (r"تقریباً", "حدوداً"),
    (r"قطعاً", "حتماً"),
    (r"احتمالاً", "شاید"),
    (r"معمولاً", "معمولاً دیگه"),
    (r"به طور کلی", "در کل"),
    (r"به صورت کامل", "کامل کامل"),

    # ==== ضمایر، اشاره‌ها، افراد ====
    (r"ایشان", "اونا"),
    (r"وی", "اون"),
    (r"این افراد", "این آدما"),
    (r"کسانی که", "آدمایی که"),
    (r"مردم", "ملت"),
    (r"افراد", "بندگان خدا"),
    (r"عده‌ای", "یه سریا"),
    (r"تعداد زیادی", "خیلیا"),
    (r"همه", "همه‌شون"),

    # ==== ترکیبات و عبارات ادبی / رسمی ====
    (r"در صورتی که", "اگه"),
    (r"به عبارت دیگر", "یعنی چی؟ یعنی اینکه"),
    (r"در حقیقت", "در واقع"),
    (r"چنانچه", "اگه"),
    (r"مطابق با", "طبق"),
    (r"علی‌رغم", "با اینکه"),
    (r"در نتیجه", "در نهایت"),
    (r"بر این اساس", "بر همین پایه"),
    (r"بدین ترتیب", "اینجوری"),
    (r"به همین دلیل", "واسه همین"),
    (r"به موجب", "بر اساس"),
    (r"حسب", "طبقِ"),

    # ==== عبارات ربط‌دهنده ====
    (r"اما", "ولی"),
    (r"اگرچه", "با اینکه"),
    (r"زیرا", "چون که"),
    (r"چرا که", "چون"),
    (r"در حالی که", "وقتی که"),
    (r"همچنین", "همین‌طور"),
    (r"علاوه بر این", "از اون گذشته"),
    (r"با این حال", "با اینکه اینطوریه"),

    # ==== اصطلاحات پرتکرار رسمی → گفتاری ====
    (r"به عنوان مثال", "مثلاً"),
    (r"از سوی دیگر", "از یه طرف دیگه"),
    (r"در این زمینه", "تو این مورد"),
    (r"در این خصوص", "راجع به این قضیه"),
    (r"در مورد", "راجع به"),
    (r"برخی اوقات", "بعضی وقتا"),
    (r"در پایان", "آخرش"),
    (r"در ابتدا", "اولش"),
    (r"پیش‌تر", "قبلاً"),
    (r"سپس", "بعدش"),
    (r"همان‌طور که", "همون‌جور که"),

    # ==== کلمات کمی / مقداری ====
    (r"تمام", "همه‌ی"),
    (r"برخی", "یه تعدادی"),
    (r"اندکی", "یه کمی"),
    (r"کمتر", "کم‌تر"),
    (r"بیشتر", "بیش‌تر"),
    (r"مقداری", "یه‌خورده"),
    (r"به مقدار زیادی", "خیلی زیاد"),
]


# 6. درهم‌آمیزی سبک رسمی و غیررسمی
style_mix = [
    lambda t: "ازت پنهون نباشه، " + t,
    lambda t: "من بارها اینو از نزدیک دیدم: " + t,
    lambda t: "یه نکته‌ای که خیلیا نادیده می‌گیرن اینه که " + t,
    lambda t: "باور کن اگه جای من بودی، می‌فهمیدی که " + t,
    lambda t: "به قول قدیمیا، هر چی سنگه واسه پای لنگه؛ " + t,
    lambda t: "چیزی که زمان یادم داد اینه که " + t,
    lambda t: "اگه هزار بار هم برگردم عقب، باز به این نتیجه می‌رسم که " + t,
    lambda t: "بذار خیلی صادقانه بگم: " + t,
    lambda t: "هر وقت تو زندگی گیج شدم، یه چیز نجاتم داد: " + t,
    lambda t: "از دل تجربه‌های سخت، فهمیدم که " + t,
    lambda t: "هیچ‌وقت فراموش نمی‌کنم اون روزی رو که فهمیدم " + t,
    lambda t: "این حرف رو نه فقط از سر کتاب، بلکه از زندگی یاد گرفتم: " + t,
    lambda t: "بارها با خودم گفتم: " + t,
    lambda t: "تو خلوت خودم زیاد بهش فکر کردم: " + t,
    lambda t: "به عنوان کسی که تلخی‌ها و شیرینی‌ها رو دیده، می‌گم: " + t,
    lambda t: "از ته دل می‌گم، چون از دل روزگار دراومده: " + t,
    lambda t: "خودم بارها زمین خوردم تا بفهمم که " + t,
    lambda t: "هیچ‌کس نمی‌تونه اینو بهتر از کسی که تجربه‌ش کرده بگه: " + t,
    lambda t: "به چشم خودم دیدم که " + t,
    lambda t: "سال‌ها طول کشید تا بفهمم " + t,
    lambda t: "بذار یه چیزیو با اطمینان بگم: " + t,
    lambda t: "چیزی که خیلیا نمی‌فهمن اینه که " + t,
    lambda t: "تا تو دل ماجرا نباشی، نمی‌فهمی که " + t,
    lambda t: "با خون دل فهمیدم که " + t,
    lambda t: "همیشه به خودم می‌گم: " + t,
    lambda t: "آدم هر چی جلوتر می‌ره، می‌فهمه که " + t,
    lambda t: "وقتی به عقب نگاه می‌کنم، فقط یه چیز برام واضحه: " + t,
    lambda t: "یه جاهایی زندگی خودش بهت می‌گه که " + t,
    lambda t: "با تجربه‌ی سال‌ها آزمون و خطا، رسیدم به این: " + t,
    lambda t: "همیشه به شاگردام می‌گم: " + t,
    lambda t: "یاد گرفتم حرفی که از دل در بیاد، می‌ره تو دل؛ مثل این: " + t,
    lambda t: "شاید ساده به نظر بیاد، ولی پشتش یه عمر تجربه‌ست: " + t,
    lambda t: "یه بار یه آدم خیلی باتجربه بهم گفت: " + t,
    lambda t: "با همه‌ی شکست‌هام، یه چیز همیشه برام ثابت مونده: " + t,
    lambda t: "اگه بخوام با یه جمله خلاصش کنم: " + t,
    lambda t: "همیشه یه جایی ته ذهنم هست که می‌گه: " + t,
    lambda t: "چیزی که بارها و بارها به خودم یادآوری کردم اینه: " + t,
    lambda t: "تو موقعیت‌های حساس، یه جمله همیشه کمکم کرده: " + t,
    lambda t: "از کسی که خیلی مسیر رفته بشنو: " + t,
    lambda t: "اگه بخوای راهو کوتاه‌تر بری، بهتره از تجربه‌ی بقیه بشنوی: " + t,
    lambda t: t + " و این حرفِ یه آدمیه که بارها زمین خورده ولی بلند شده.",
    lambda t: t + "، و اینو از کسی بشنو که از دور نگاه نکرده، از تو دل ماجرا بوده.",
    lambda t: "این فقط یه جمله نیست، یه زندگی پشتشه: " + t,
    lambda t: "اگه امروز به عقب نگاه می‌کنم، فقط به خاطر اینه که بفهمم " + t,
    lambda t: "اگه بخوام با چکیده‌ی تجربه‌هام بگم: " + t,
    lambda t: "هر وقت حس می‌کنم گیجم، به خودم یادآوری می‌کنم که " + t,
    lambda t: "یه مشاور خوب یه بار اینو بهم گفت و هیچ‌وقت یادم نرفت: " + t,
    lambda t: "زندگی گاهی یه استاد سخت‌گیره، ولی درساش اینن: " + t,
    lambda t: "به قول مادربزرگم، زندگی آدمو آب‌دیده می‌کنه، مثل وقتی که " + t,
    lambda t: "چیزی که زمان بهت یاد می‌ده، هیچ کتابی نمی‌تونه: " + t,
    lambda t: "تجربه، با همه‌ی تلخیاش، بهترین معلمه؛ مثل وقتی که " + t,
    lambda t: "یه روزی بود که هیچ‌کدوم از اینا رو نمی‌فهمیدم، ولی الان می‌دونم که " + t,
    lambda t: "به قول یه استاد قدیمی‌مون: " + t,
]


def simulate_typo(text):
    replacements = {
    "می‌شود": ["میشود", "می شه", "می‌تونه بشه"],
    "نمی‌شود": ["نمی شه", "نمیشه", "نمی‌تونه بشه"],
    "است": ["هست", "هستش", "یه جوراییه"],
    "نیست": ["نی", "نیستش", "نی‌س"],
    "خواهد بود": ["قراره باشه", "می‌خواد باشه"],
    "نخواهد بود": ["قرار نیست باشه", "نمی‌خواد باشه"],
    "باید": ["باید که", "لازمه", "ضروریه"],
    "نباید": ["نبايد", "لازم نیست", "نیازی نیست"],
    "می‌باشد": ["هست", "محسوب می‌شه", "می‌شه گفت هست"],
    "نمی‌باشد": ["نیست", "محسوب نمی‌شه"],
    "خواهد شد": ["می‌شه", "می‌تونه بشه", "اتفاق می‌افته"],
    "نخواهد شد": ["نمیشه", "اتفاق نمی‌افته"],
    "استفاده می‌شود": ["به کار می‌ره", "مصرف می‌شه", "کاربرد داره"],
    "در صورتی که": ["اگه", "اگه که", "اگه بخوای"],
    "همچنین": ["هم‌چنین", "بعلاوه", "از اون طرفم"],
    "بنابراین": ["پس", "واسه همین", "در نتیجه"],
    "به دلیل": ["به خاطر", "واسه‌ی", "علتش اینه که"],
    "وجود دارد": ["هست", "پیدا می‌شه", "موجوده"],
    "وجود ندارد": ["نیست", "پیدا نمی‌شه", "وجود نداره"],
    "ممکن است": ["شاید", "احتمالش هست", "بعید نیست"],
    "ضروری است": ["لازمه", "واجبه", "مهمه"],
    "قابل توجه است": ["جالبه", "باحاله", "قابل بحثه"],
    "در نهایت": ["آخر سر", "تهش", "بالاخره"],
    "در واقع": ["در اصل", "یعنی", "در حقیقت"],
    "همواره": ["همیشه", "دائم", "مدام"],
    "به طور کلی": ["کلاً", "در کل", "به‌صورت کلی"],
    "بر اساس": ["طبقِ", "بر پایه‌ی", "با توجه به"],
}

    for k, v in replacements.items():
        text = re.sub(rf"\b{k}\b", random.choice(v), text)
    return text




# 🔁 جایگزینی رسمی با عامیانه
def apply_slang(text):
    for formal, informal_options in slang_replacements.items():
        informal = random.choice(informal_options)
        pattern = rf"\b{re.escape(formal)}\b"
        text = re.sub(pattern, informal, text)
    return text



# 🗣️ افزودن حس انسانی
def add_human_touch(text):
    sentences = re.split(r'(?<=[.!؟])\s+', text)
    modified = []
    for s in sentences:
        if random.random() < 0.2:
            prefix = random.choice(human_touch)
            s = f"{prefix} {s}"
        modified.append(s)
    return " ".join(modified)

# 😀 افزودن اموجی

# 🧠 بررسی رسمی بودن متن
def is_too_formal(text):
    formal_keywords = list(slang_replacements.keys())
    score = sum(1 for word in formal_keywords if re.search(rf"\b{re.escape(word)}\b", text))
    return score >= 3 or len(text.split()) > 100

# 🌀 کمی اختلال عمدی طبیعی
def add_minor_disorder(text):
    parts = text.split('.')
    if len(parts) > 1:
        parts[random.randint(0, len(parts)-2)] += '...'
        text = '.'.join(parts)
    return text

# 🧩 تابع نهایی بازنویسی چندمرحله‌ای برای عبور از ZeroGPT
def make_more_human_if_needed(text, iterations=5):
    current_text = text
    for i in range(iterations):
        if is_too_formal(current_text):
            print(f"🌀 تلاش {i+1} برای انسانی‌سازی متن...")
            current_text = apply_slang(current_text)
            current_text = add_human_touch(current_text)
            if random.random() < 0.4:
                current_text = add_minor_disorder(current_text)
        else:
            break
    return current_text

# 🎯 تابع ساده‌تر بازنویسی (در صورت نیاز)
def rewrite_ai_response(text):
    try:
        return make_more_human_if_needed(text)
    
    except Exception as e:
        print(f"❌ خطا در بازنویسی: {e}")
        return text

def split_text_for_telegram(text, max_length=4000):
    parts = []
    while len(text) > max_length:
        # دنبال مناسب‌ترین جای ممکن برای بریدن می‌گردیم
        split_index = max(
            text.rfind("\n", 0, max_length),
            text.rfind(". ", 0, max_length),
            text.rfind("! ", 0, max_length),
            text.rfind("? ", 0, max_length),
            text.rfind(" ", 0, max_length - 1)
        )
        if split_index == -1 or split_index < 200:  # اگه نقطه‌ای برای بریدن پیدا نشد
            split_index = max_length
        parts.append(text[:split_index].strip())
        text = text[split_index:].strip()
    if text:
        parts.append(text)
    return parts

def super_humanize(text, iterations=5):
    current_text = text
    for i in range(iterations):
        if is_too_formal(current_text):
            print(f"✨ ارتقاء انسانی‌سازی – مرحله {i+1}")
            current_text = apply_slang(current_text)
            current_text = paraphrase_structure(current_text)
            current_text = add_human_touch(current_text)
            current_text = insert_minor_irrelevance(current_text)
            current_text = simulate_typo(current_text)
            if random.random() < 0.4:
                current_text = add_minor_disorder(current_text)
        else:
            break
    return current_text




# 7. تابع نهایی: اجرای همه مراحل
def humanize_text(text):
    # مرحله 1 و 2 و 3: اضافه کردن لحن، تجربه، حشو
    pre_text = random.choice(tones) + random.choice(human_like_glitches) + " " + random.choice(personal_touch) + " "
    
    # مرحله 4: اضافه کردن ارجاع
    ref = " " + random.choice(references)
    
    # مرحله 5: تغییر ساختار زبانی
    for pattern, replacement in structure_replacements:
        text = re.sub(pattern, replacement, text)
    
    # مرحله 6: تغییر سبک
    text = random.choice(style_mix)(text)
    
    # مرحله 7: نهایی
    return pre_text + text + ref


from hazm import Normalizer, WordTokenizer, POSTagger, Lemmatizer, SentenceTokenizer
import random

def hazm_humanize(text):
    normalizer = Normalizer()
    word_tokenizer = WordTokenizer()
    sentence_tokenizer = SentenceTokenizer()
    tagger = POSTagger(model='resources/postagger.model')
    lemmatizer = Lemmatizer()
    
    # نرمال‌سازی متن
    text = normalizer.normalize(text)
    
    # تقسیم به جملات
    sentences = sentence_tokenizer.tokenize(text)
    modified_sentences = []
    
    for sentence in sentences:
        # توکن‌سازی و تحلیل ساختاری
        words = word_tokenizer.tokenize(sentence)
        tagged = tagger.tag(words)
        
        # جایگزینی کلمات رسمی با عامیانه
        for i, (word, tag) in enumerate(tagged):
            # جایگزینی افعال
            if tag in ['V', 'AUX'] and word in slang_replacements:
                words[i] = random.choice(slang_replacements[word])
            # جایگزینی صفت‌ها یا قیدها
            elif tag in ['ADJ', 'ADV'] and word in slang_replacements:
                words[i] = random.choice(slang_replacements[word])
            # ساده‌سازی با لماتیزه کردن
            elif tag == 'V' and random.random() < 0.2:
                lemma = lemmatizer.lemmatize(word)
                words[i] = lemma if lemma in slang_replacements else random.choice(slang_replacements.get(word, [word]))
    
    return " ".join(modified_sentences)


# 🎯 تابع ساده‌تر بازنویسی (در صورت نیاز)
def rewrite_ai_response(text):
    try:
        return make_more_human_if_needed(text)
    except Exception as e:
        print(f"❌ خطا در بازنویسی: {e}")
        return text
